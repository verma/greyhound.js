(function e$$0(f,k,h){function c(b,a){if(!k[b]){if(!f[b]){var d="function"==typeof require&&require;if(!a&&d)return d(b,!0);if(l)return l(b,!0);throw Error("Cannot find module '"+b+"'");}d=k[b]={exports:{}};f[b][0].call(d.exports,function(g){var a=f[b][1][g];return c(a?a:g)},d,d.exports,e$$0,f,k,h)}return k[b].exports}for(var l="function"==typeof require&&require,a=0;a<h.length;a++)c(h[a]);return c})({1:[function(e,f,k){f.exports=e("./lib/greyhound")},{"./lib/greyhound":2}],2:[function(e,f,k){var h=
e("ws"),c=function(){var a=[],b=function(b,d,g){d=d||"floating";g=g||4;return function(m,c){m=m||d;c=c||g;a.push({name:b,type:m,size:c});return a}};a.X=b("X");a.Y=b("Y");a.Z=b("Z");a.Intensity=b("Intensity","unsigned",2);a.Red=b("Red","unsigned",2);a.Green=b("Green","unsigned",2);a.Blue=b("Blue","unsigned",2);return a};c.standard=function(){return c().X().Y().Z().Intensity().Red().Green().Blue()};c.XYZ=function(){return c().X().Y().Z()};e=function(a){if(!a)throw Error("Need hostname to initialize reader");
if(a.match(/^(\S+):\/\//))throw Error("Protocol specified, need bare hostname");this.host=a;a=this.host.match(/:(\d+)$/);this.port=null!==a?parseInt(a[1]):80;if(a=this.host.match(/^(\S+):/))this.host=a[1]};var l=function(a){setTimeout(a)};e.prototype.getHost=function(){return this.host};e.prototype.createSession=function(a,b){if(!a||"function"===typeof a)throw Error("Invalid pipeline");this._withConn(function(c,d){if(c)return b(c);d.cmd({command:"create",pipelineId:a},function(a,d){if(a)return b(a);
console.log("Got stuff",a,d);b(null,d.session)})})};e.prototype.read=function(a,b,e){if(!a||"function"===typeof a)throw Error("Invalid session parameter");console.log(typeof b);"function"===typeof b&&(e=b,b={});b=b.schema||c.standard();console.log("schema: ",b);var d={command:"read",session:a,schema:{dimensions:b}};this._withConn(function(b,a){if(b)return e(b);a.cmd(d,function(b,g){if(b)return e(b);a.readBinary(g.numBytes,function(b,a){if(b)return e(b);e(null,{numPoints:g.numPoints,numBytes:g.numBytes,
data:a})})})})};e.prototype.destroy=function(a,b){if(!a||"function"===typeof a)throw Error("Invalid session parameter");this._withConn(function(c,d){if(c)return b(c);d.cmd({command:"destroy",session:a},function(a,d){if(a)return b(a);b()})})};e.prototype.getPort=function(){return this.port};e.prototype._withConn=function(a){if(this.conn)return l(a.bind(null,null,this.conn));var b=this,c="ws://"+this.getHost()+":"+this.getPort()+"/";console.log("Using URI:",c);var d=new h(c);d.binaryType="arraybuffer";
console.log("Creating websocket");this.binary=null;d.onopen=function(){console.log("on open");b.ws=d;b.handlers={};b.conn={cmd:function(a,c){if(a.command)b.handlers[a.command]=c,b.ws.send(JSON.stringify(a));else{var d=c.bind(null,Error("No command parameter"));setTimeout(d)}},readBinary:function(a,c){b.binary={sofar:0,bytesLeft:a,dataBuffer:new Int8Array(a),cb:c}}};console.log("Opened!");l(a.bind(null,null,b.conn))};d.onerror=function(){b.ws=null;for(var c in b.handlers)b.handlers[c](Error("Connection error"));
console.log("Dispatching error function");c=a.bind(null,Error("Connection error"));setTimeout(c)};d.onclose=function(){b.ws=null};d.onmessage=function(a){if(a.data instanceof ArrayBuffer){console.log("on binary");if(!b.binary)return console.log("Got binary when no binary transmission in progress");a=new Int8Array(a.data);b.binary.dataBuffer.set(a,b.binary.sofar);b.binary.sofar+=a.length;b.binary.bytesLeft-=a.length;if(0>=b.binary.bytesLeft){a=b.binary.dataBuffer;var c=b.binary.cb;b.binary=null;a=
c.bind(null,null,a);setTimeout(a)}}else if(console.log("on data message"),console.log(a),a=JSON.parse(a.data),c=a.command){var d=b.handlers[c];d&&(delete b.handlers[c],1!==a.status?(a=d.bind(null,Error(a.reason||"Unknown Error")),setTimeout(a)):d(null,a))}};console.log("Ive setup everything, waiting for notifications now");this.ws=d};f.exports={Schema:c,GreyhoundReader:e}},{ws:3}],3:[function(e,f,k){function h(e,a,b){return a?new c(e,a):new c(e)}e=function(){return this}();var c=e.WebSocket||e.MozWebSocket;
f.exports=c?h:null;c&&(h.prototype=c.prototype)},{}]},{},[1]);
